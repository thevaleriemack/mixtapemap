<!DOCTYPE html>
<html>
    <head>
        <!--  Please note Bootstrap is only used solely for the grid and table layouts.  -->
        <title>5100 Masters Capstone - Created by Denay Mack (dgm97)</title>
        <link rel="stylesheet/less" type="text/css" href="assets/stylesheets/main.less" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous"/>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.7.2/less.min.js"></script>
        <script src="https://connect.soundcloud.com/sdk/sdk-3.1.2.js"></script>
    </head>
    <body>
        <div class="container">
            <header>
                <h1>Mix Tape Map</h1>
                <h2>5100 Masters Capstone</h2>
                <ul>
                    <li>About</li>
                </ul>
            </header>
            <div class="row">
                <div class="col-lg-2"></div>
                <div class="col-lg-8">
                    <svg id="visualization">
                    </svg>            
                    <!-- <table class="table">
                        <thead>
                            <tr>
                              <th>#</th>
                              <th>Song</th>
                              <th>Artist</th>
                              <th>Play</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th scope="row">1</th>
                                <td>Redemption Song</td>
                                <td>Bob Marley</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table> -->
                </div>
                <div class="col-lg-2"></div>
            </div>
        </div>
        <script>
            /*************************
            ********* app.js *********
            **************************/
            
            var width = 700;
            var height = 700;
            
            var svg = d3.select("#visualization")
            .attr("width", width)
            .attr("height", height);
            
            var data = {};
            var nodes = [],
                links = [];
            
            var force = d3.forceSimulation() 
            .force("charge", d3.forceManyBody().strength(-700).distanceMin(100).distanceMax(1000)) 
            .force("link", d3.forceLink().id(function(d) { return d.index })) 
            .force("center", d3.forceCenter(width / 2, height / 2))
            .force("y", d3.forceY(0.001))
            .force("x", d3.forceX(0.001));
            
            

        d3.json("songs.json", function (error, json) {
            if (error) throw error;
            nodes = json.nodes;
            
            for (var i = 1; i < nodes.length; i++) {
                links.push({"source":0, "target": i})
            }
            
            force
                .nodes(json.nodes) 
                .force("link").links(links);
            
            var link = svg.selectAll(".link")
                .data(links)
                .enter()
                .append("line")
                .attr("class", "link");
            
            var node = svg.selectAll(".node")
                .data(json.nodes)
                .enter().append("g")
                .attr("class", "node");  
            
            node.append('circle')
            .attr('r', 13)
            .attr('fill', function (d) {
                return d.group;
            })
            .on("mouseover", showData)
            .on("mouseout", hideData)
            .on("click", nodeSelected);
            
            node.append("text")
            .attr("dx", 30)
            .attr("dy", 5)
            .style("font-family", "sans-serif")
            .style("font-size", "18px")
            .attr("fill", "black")
            .text(function (d) {
                return d.name
            });
            
            force.on("tick", function () {
                link.attr("x1", function (d) {
                        return d.source.x;
                    })
                    .attr("y1", function (d) {
                        return d.source.y;
                    })
                    .attr("x2", function (d) {
                        return d.target.x;
                    })
                    .attr("y2", function (d) {
                        return d.target.y;
                    });
                node.attr("transform", function (d) {
                    return "translate(" + d.x + "," + d.y + ")";
                });
            });
        });

            function nodeSelected(d) {
                console.log(d);
                d.group="blue";
            }
            
            function showData() {
                return;
            }
            function hideData() {
                return;
            }
        </script>
    </body>
</html>